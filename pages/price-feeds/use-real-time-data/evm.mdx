---
description: Consume Pyth Network prices in EVM applications
---

# How to Use Real-Time Data in EVM Contracts

This guide explains how to use real-time Pyth data in EVM contracts. For an interactive playground to explore the methods supported by the Pyth contract, see the [EVM API reference](../api-reference/evm/).

## Install Pyth SDK

Pyth provides a [Solidity SDK](https://github.com/pyth-network/pyth-crosschain/tree/main/target_chains/ethereum/sdk/solidity) to fetch prices from Pyth contracts.
The SDK exposes `IPyth` interface to interact with Pyth price feeds

**Truffle/Hardhat**

If you are using Truffle or Hardhat, simply install the NPM package:

```bash copy
npm install @pythnetwork/pyth-sdk-solidity
```

**Foundry**

If you are using Foundry, you will need to create an NPM project if you don't already have one.
From the root directory of your project, run:

```bash copy
npm init -y
npm install @pythnetwork/pyth-sdk-solidity
```

Then add the following line to your `remappings.txt` file:

```text copy
@pythnetwork/pyth-sdk-solidity/=node_modules/@pythnetwork/pyth-sdk-solidity
```

## Write Contract Code

The code snippet below provides a general template for what your contract code should look like:

```solidity copy
pragma solidity ^0.8.0;

import "@pythnetwork/pyth-sdk-solidity/IPyth.sol";
import "@pythnetwork/pyth-sdk-solidity/PythStructs.sol";

contract SomeContract {
  IPyth pyth;

  /**
   * THIS IS AN EXAMPLE CONTRACT. IT IS NOT INTENDED TO BE USED IN PRODUCTION.
   * THIS CONTRACT IS FOR DEMONSTRATION PURPOSES ONLY.
   */

  /**
      * Instantiate IPyth interface with the address of the Pyth contract.
      * Pyth contract address can be found at https://docs.pyth.network/price-feeds/contract-addresses/evm.

      * @param pythContract The address of the Pyth contract
      */
  constructor(address pythContract) {
    pyth = IPyth(pythContract);
  }

  /**
     * This function is an example of how to interact with the Pyth contract.

     * Fetch the updateData from an off-chain service and pass it to the Pyth contract to update the price feeds.
     * See https://docs.pyth.network/price-feeds/how-pyth-works/hermes for more information on how to fetch the updateData.

     * @param priceUpdateData The updateData to update the contract with the latest price
     */
  function fetchPrice(bytes[] calldata priceUpdateData) public payable {
    // IMPORTANT: Here we fetch the fee required to update the price
    // and update the contract with the latest price
    uint fee = pyth.getUpdateFee(priceUpdateData);
    pyth.updatePriceFeeds{ value: fee }(priceUpdateData);

    // Read the current price
    // The priceIds can be found at https://pyth.network/developers/price-feed-ids
    bytes32 priceId = 0xff61491a931112ddf1bd8147cd1b641375f79f5825126d665480874634fd0ace; // ETH/USD
    PythStructs.Price price = pyth.getPrice(priceId);
  }
}

```

## Write Frontend Code

Add frontend code to query price update data and pass it to your contract.
Your frontend code should do the following things:

1. Get a Hermes instance from the list of providers [here](https://docs.pyth.network/price-feeds/api-instances-and-providers/hermes#node-providers). You can use the Stable [Hermes instance] hosted publically by Pyth Data Assosciation for development purposes.
1. Instantiate an [EvmPriceServiceConnection](https://github.com/pyth-network/pyth-crosschain/blob/main/target_chains/ethereum/sdk/js/src/EvmPriceServiceConnection.ts) pointing to your Hermes instance.
1. Get price update data using this connection -- you can either perform one-off queries for this using `getPriceFeedsUpdateData` or subscribe for real-time updates via websocket.
1. Optionally get the Pyth fee required to perform the price update.
   You will need to do this step if your app is passing Pyth fees on to end users.
1. Pass the price update data to your contract.
   If you are passing along pyth fees, you will additionally need to provide the `value` parameter with the fee from the previous step.

```typescript copy
import { EvmPriceServiceConnection } from "@pythnetwork/pyth-evm-js";

async function run() {
  const connection = new EvmPriceServiceConnection("https://hermes.pyth.network");
  const priceIds = ["fill this in with your ids"]
  const priceFeedUpdateData = await connection.getPriceFeedsUpdateData(
    priceIds
  );

  // If necessary, you can collect the price update fee from the pythContract.
  //
  // `pythContract` below is a web3.js contract; if you wish to use ethers, you need to change it accordingly.
  // You can find the Pyth interface ABI in @pythnetwork/pyth-sdk-solidity npm package.
  const pythContract = ...;
  const updateFee = await pythContract.methods
    .getUpdateFee(priceFeedUpdateData)
    .call();

  // Pass the update data to your contract.
  // `someContract` below is a web3.js contract; if you wish to use ethers, you need to change it accordingly.
  const someContract = ...;
  await someContract.methods
    .doSomething(someArg, otherArg, priceFeedUpdateData)
    .send({ value: updateFee });
}

run();
```

## Additional Resources

You may find these additional resources helpful for developing your EVM application.

### API Reference

The [EVM API reference](../api-reference/evm/) lets you interactively explore the complete API of the Pyth contract.

### Error Codes

The [EVM error codes](../error-codes/evm/) page lists the error codes that the Pyth contract may return.

### Example Applications

[Oracle Swap](https://github.com/pyth-network/pyth-examples/tree/main/price_feeds/evm/oracle_swap) is an end-to-end example application that uses Pyth Network price feeds.
This application is an AMM that allows users to swap two assets at the Pyth-provided exchange rate. The example contains both the contract and a frontend to interact with it.
