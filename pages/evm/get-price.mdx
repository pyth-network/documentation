import Input from '../../components/Input';
import Arg from '../../components/Arg';
import Example from '../../components/Example';
import DynamicCode from '../../components/DynamicCode';
import DisplayKeyValueStore from '../../components/DisplayKeyValueStore';
import EvmCall from '../../components/EvmCall';
import {Tab, Tabs} from 'nextra-theme-docs';

# Get Price
**getPrice(id)**

Get the latest on-chain price for the requested price feed id.
Note: you typically need to update the on-chain price using (link) before calling this function.

| Argument                                      |  | Description |
|-----------------------------------------| --- | --- |
| <Arg required={true} type="hex">id</Arg> | <Input id="id" /> | The ID of the price feed you want to read |

Examples:
<Example keyValues={{
    "id": (ctx) => ctx.getFeedId('Crypto.BTC/USD')
}}>BTC/USD</Example>
<Example keyValues={{
    "id": (ctx) => ctx.getFeedId('Crypto.ETH/USD')
}}>ETH/USD</Example>

// TODO: fix this functionName
<EvmCall
  functionName="getPriceUnsafe"
  argumentKeys={["id"]}
/>

## Example Code

<Tabs items={['Solidity', 'ethers.js', 'web3.js']}>
  <Tab>
    <DynamicCode targets={{
        "0x0000": (ctx) => ctx.evmConfig.pythAddress,
        "0x1111": (ctx) => ctx.get("id", "<id>"),
        "// NETWORK_NAME": (ctx) => `// ${ctx.evmConfig.info.chainName}`,
    }}>
      ```solidity
      import "pyth-sdk-solidity/IPyth.sol";
      import "pyth-sdk-solidity/PythStructs.sol";

      // Sample code for
      // NETWORK_NAME
      address contractAddress = 0x0000;
      bytes32 priceId = 0x1111;
      IPyth pyth = IPyth(contractAddress);
      PythStructs.Price memory currentBasePrice = pyth.getPrice(priceId);
      ```
    </DynamicCode>
  </Tab>

  <Tab>
    <DynamicCode targets={{
        "'0x0000'": (ctx) => `'${ctx.evmConfig.pythAddress}'`,
        "'0x1111'": (ctx) => `'${ctx.get("id", "<id>")}'`,
    }}>
      ```typescript
      const contractAddress = '0x0000';
      const priceId = '0x1111';
      const pythAbi = require('./abis/IPyth.json');
      const contract = new ethers.Contract(contractAddress, pythAbi, provider);
      const [price, conf, expo, timestamp] = await contract.getPrice(priceId);
      ```
    </DynamicCode>
  </Tab>
</Tabs>
